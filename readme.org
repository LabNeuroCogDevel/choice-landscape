* Landscape choice

 * see running version: https://labneurocogdevel.github.io/choice-landscape/
 * aesthetic motivated by [[https://elifesciences.org/articles/59907][Dubois et al 2021 elife]] task: [[https://iiif.elifesciences.org/lax/59907%2Felife-59907-fig1-v2.tif/full/1500,/0/default.jpg][landscape with choices]]

* Bugs
** uses keypress sent during :waiting/:feedback for next :chose
   need to block so keypress is only listening during :chose
   or clear any keypresses when phase changes?
   -- might want some cheat codes (e.g. d enables debug, r for restart, etc)
** :right as best prob well has collision issue! avatar never finds it!
** :record iti-time is overwritten
  something is amiss in phase/phone-home
  :iti is hit but time is not in POST command
** instructions should include note about +
   and maybe we gray out the avatar instead?
** preload sounds
** survey doesn't change with arrow push

* Hosting 
  
** Heroku
 Using [[./Procfile][~Procfile~]] on heroku w/ ~addon:heroku-postgres~ and https://github.com/LabNeuroCogDevel/psiclj buildpack

* implementation
** instructions/state advance
   instructions step through individual actions (sprites, buckets, etc)
** TODO [#A] allow for fixed timing
  scanner will be given explicit onset targets
** update well probabilities on fixed schedule
   currently generated by model.timeline/gen-wells with fixed 20/50 probs
*** add 100/100/100 event
    last event is the test of habit. the far well is no longer effect. can get always get reward from a closer well

** integrated with http server
   POST requests are made before the transition from feedback to iti. intended to be picked up by ~psiclj~ tool/server
** TODO [#B] use full screen
*** zoom body?
    ~translation: scale(1.5)~ works for content but does not scale background.
    with lower wells, maybe less of a problem
*** bigger images?
    bad idea for smaller screens?
** TODO [#C] photodiode color block in some corner
   so we can continue to use browser for sEEG
** touch well simulates keypress
   works on wells and instruction button. BUT there is no indication that's what happened.
*** TODO [#C] include :touch true in keypress
    this looks like it'd be hard to integrate
** TODO [#C] set scale of water relative to total points needed
   would make task usable on a phone
** TODO [#C] visually collect status of wells
   not necissary. maybe problematic. would be useful for debugging though
   debugging with probability text over well would be useful too

   bar at bottom with color for success?
   X or O next to the well?
** TODO [#C] arrows
*** sprites.
   maybe css instead? colored?
*** placement logic
** wells
*** placement logic
    :LOGBOOK:
    CLOCK: [2021-09-22 Wed 08:06]--[2021-09-22 Wed 09:17] =>  1:11
    :END:
    also fixed a loop bug and stopped animation if active-at is 0
**** exponential decrease. make function to be reused by stepping stones
     hard coded sequence ~:step-sizes~ in ~model/BOARD~

*** set and indicate dis/enabled well
    currently have a bucket on active wells. could still use animations
**** TODO [#C] animate bucket
     have start of animation in wells.svg but crashes inkscape. not critical to task

*** TODO [#C] color icon to distinguish wells
    maybe this isn't needed

** avatar movement
   :LOGBOOK:
   CLOCK: [2021-09-22 Wed 09:27]--[2021-09-22 Wed 11:43] =>  2:16
   :END:
   had up/down swapped in ~which-dir~. took forever to debug!
   how fast to move? accepting keypress?
** handle key presses
   :LOGBOOK:
   CLOCK: [2021-09-22 Wed 11:57]--[2021-09-22 Wed 12:54] =>  0:57
   :END:
   keypress injected directly into state
*** TODO restrict keypress, don't hard code positions
** github pages
 useful to share. need ~.nojekyll~ file to use index.html and friends.

** sounds
   copied cash and buz
** feedback
   water fill and sound
*** TODO [#C] maybe add text or stars?
**  ISI/ITI
*** ITI with fixation cross
    may want to change to grayed avatar
*** ISI
    * might not need. depends on modeling
    * shake the well for variable time before showing reward
    * intermediate helper goes to the well instead. (bring bucket, drill, etc).
      can be disgruntled or happy
** TODO add animation to devcards
   still haven't figured out. but animating for the instruction choice screen helped debug bad frames
** TODO [#A] :done state
   * POST to /finished, show finish indicator
** TODO [#B] survey
    * add results to :record, might need to reorganize top level
    * allow textbox for non-MR (why pick well all at 100%, other thoughts)
    * stylize
